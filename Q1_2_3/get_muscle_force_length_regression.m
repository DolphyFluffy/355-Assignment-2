function [force_length_regression] = get_muscle_force_length_regression()
%%% TASK 2

% Input Parameters
% data(:,1): samples of an independent variable
% data(:,2): corresponding samples of a dependent variable

% Output
% force_length_regression: the genered Gaussian model

%     WRITE CODE HERE
%      1) Use WebPlotDigitizer to extract force-length points
%     from Winters et al. (2011) Figure 2C, which is on Learn. Click
%     "View Data", select all, cut, and paste below. 
%     2) Normalize the data so optimal length = 1 and peak = 1. 
%     3) Return a Regression object that uses Gaussian basis functions.

% Define data points
data = [37.38255033557047, 9.487179487179489
    38.32214765100671, 14.35897435897435
    39.194630872483216, 24.35897435897435
    40.26845637583892, 36.66666666666667
    39.32885906040268, 3.333333333333343
    41.74496644295302, 1.7948717948717956
    40.402684563758385, 17.43589743589743
    41.34228187919463, 14.35897435897435
    41.40939597315436, 15.897435897435898
    40.335570469798654, 21.538461538461533
    43.758389261744966, 22.051282051282044
    42.81879194630872, 23.58974358974359
    43.355704697986575, 23.58974358974359
    41.34228187919463, 26.410256410256423
    41.34228187919463, 31.794871794871796
    42.013422818791945, 31.794871794871796
    43.355704697986575, 35.12820512820514
    42.48322147651007, 41.794871794871796
    45.50335570469798, 43.58974358974359
    46.57718120805369, 44.61538461538463
    45.50335570469798, 46.66666666666666
    45.50335570469798, 45.8974358974359
    44.36241610738254, 45.38461538461539
    43.355704697986575, 44.87179487179486
    42.75167785234899, 46.41025641025641
    42.75167785234899, 48.46153846153847
    43.08724832214765, 50
    45.30201342281879, 53.846153846153854
    45.23489932885906, 54.1025641025641
    43.355704697986575, 54.1025641025641
    43.691275167785236, 57.17948717948718
    44.36241610738254, 60.51282051282051
    46.308724832214764, 62.56410256410257
    47.38255033557047, 62.82051282051282
    48.993288590604024, 63.33333333333334
    47.651006711409394, 66.66666666666667
    45.63758389261745, 67.6923076923077
    45.77181208053692, 70.51282051282051
    46.308724832214764, 71.53846153846155
    47.38255033557047, 71.53846153846155
    46.308724832214764, 73.58974358974359
    46.57718120805369, 75.64102564102564
    46.97986577181208, 80.76923076923077
    47.51677852348993, 81.7948717948718
    48.053691275167786, 83.58974358974359
    47.38255033557047, 81.7948717948718
    68.45637583892616, 27.179487179487182
    70.13422818791946, 29.48717948717949
    70.40268456375838, 29.743589743589737
    72.3489932885906, 24.615384615384627
    72.95302013422818, 25.641025641025635
    73.35570469798658, 18.461538461538453
    73.35570469798658, 17.692307692307693
    73.35570469798658, 12.820512820512832
    76.3758389261745, 8.717948717948715
    75.16778523489933, 18.205128205128204
    74.36241610738256, 12.564102564102555
    75.30201342281879, 12.820512820512832
    71.34228187919463, 34.61538461538461
    73.35570469798658, 34.358974358974365
    67.31543624161074, 35.641025641025635
    69.39597315436242, 41.794871794871796
    66.97986577181209, 42.82051282051283
    70.46979865771812, 48.46153846153847
    65.63758389261744, 47.948717948717956
    67.4496644295302, 51.794871794871796
    64.69798657718121, 52.05128205128206
    64.69798657718121, 53.33333333333333
    63.288590604026844, 52.82051282051282
    63.288590604026844, 59.48717948717949
    50.53691275167785, 74.61538461538461
    49.395973154362416, 76.15384615384616
    48.993288590604024, 81.7948717948718
    48.92617449664429, 82.30769230769232
    48.85906040268456, 85.64102564102565
    49.53020134228187, 86.66666666666667
    49.73154362416108, 85.12820512820514
    49.66442953020134, 81.7948717948718
    50.671140939597315, 78.2051282051282
    51.14093959731544, 78.71794871794873
    50.87248322147651, 80.25641025641026
    53.489932885906036, 78.71794871794873
    53.489932885906036, 83.58974358974359
    50.60402684563758, 84.87179487179488
    50.671140939597315, 87.43589743589743
    50.26845637583892, 87.69230769230771
    50.671140939597315, 90.76923076923077
    51.47651006711409, 89.74358974358975
    51.677852348993284, 91.02564102564102
    52.68456375838926, 89.23076923076923
    53.288590604026844, 88.71794871794873
    53.89261744966443, 92.05128205128206
    53.55704697986577, 92.56410256410257
    54.09395973154363, 93.84615384615384
    54.29530201342282, 94.61538461538461
    53.489932885906036, 94.87179487179488
    53.55704697986577, 96.66666666666667
    53.758389261744966, 96.92307692307693
    54.630872483221474, 99.74358974358975
    55.70469798657718, 96.15384615384616
    56.10738255033557, 96.15384615384616
    56.442953020134226, 99.74358974358975
    56.77852348993289, 99.74358974358975
    57.04697986577181, 100
    57.248322147651, 97.94871794871796
    57.51677852348993, 99.74358974358975
    57.78523489932886, 99.23076923076924
    58.5234899328859, 96.15384615384616
    58.79194630872483, 99.48717948717949
    59.328859060402685, 97.94871794871796
    59.73154362416107, 96.41025641025641
    59.53020134228188, 95.64102564102565
    60, 95.64102564102565
    60.536912751677846, 99.74358974358975
    57.718120805369125, 91.28205128205128
    58.38926174496645, 91.02564102564102
    59.261744966442954, 91.28205128205128
    60.536912751677846, 94.10256410256412
    61.2751677852349, 95.12820512820514
    62.281879194630875, 96.92307692307693
    61.2751677852349, 92.05128205128206
    61.34228187919463, 87.94871794871796
    62.14765100671141, 89.74358974358975
    61.20805369127517, 84.35897435897436
    61.34228187919463, 79.74358974358975
    61.34228187919463, 76.92307692307693
    62.61744966442953, 79.74358974358975
    63.422818791946305, 79.74358974358975
    63.35570469798658, 80.76923076923077
    63.758389261744966, 80.25641025641026
    64.49664429530202, 81.7948717948718
    63.08724832214765, 86.15384615384616
    63.6241610738255, 85.64102564102565
    63.8255033557047, 87.17948717948718
    64.49664429530202, 86.92307692307693
    63.691275167785236, 89.74358974358975
    63.95973154362416, 76.41025641025641
    65.03355704697987, 76.15384615384616
    66.30872483221476, 75.64102564102564
    65.50335570469798, 72.56410256410257
    66.04026845637584, 72.05128205128204
    65.63758389261744, 68.46153846153847
    65.7718120805369, 66.66666666666667
    65.36912751677852, 64.35897435897436
    66.7785234899329, 66.41025641025641
    67.11409395973155, 63.33333333333334
    67.71812080536913, 62.56410256410257
    68.32214765100672, 59.48717948717949];

length = data(:,1);
force = data(:,2);

% Normalization
x = length/max(length);
y = force/max(force);

% Regression with "fit" function with "gauss2" option as model type
force_length_regression = fit(x, y, 'gauss2');

end
